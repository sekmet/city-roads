webpackJsonp([1],{"+syb":function(e,t){},"F4A/":function(e,t){},LVrL:function(e,t,n){var r=n("/5HI"),o=n("MeRj").place;e.exports=function(e){var t=[],n=[],i=(new Date).toISOString();e.forEachElement(function(e){"node"===e.type?t.push(e):"way"===e.type&&n.push(e)});var a=new r;return o.write({version:1,id:e.id,date:i,name:e.name,nodes:t,ways:n},a),a.finish()}},MeRj:function(e,t,n){"use strict";var r=t.place={};r.read=function(e,t){return e.readFields(r._readField,{version:0,name:"",date:"",id:"",nodes:[],ways:[]},t)},r._readField=function(e,t,n){1===e?t.version=n.readVarint():2===e?t.name=n.readString():3===e?t.date=n.readString():4===e?t.id=n.readString():5===e?t.nodes.push(r.node.read(n,n.readVarint()+n.pos)):6===e&&t.ways.push(r.way.read(n,n.readVarint()+n.pos))},r.write=function(e,t){if(e.version&&t.writeVarintField(1,e.version),e.name&&t.writeStringField(2,e.name),e.date&&t.writeStringField(3,e.date),e.id&&t.writeStringField(4,e.id),e.nodes)for(var n=0;n<e.nodes.length;n++)t.writeMessage(5,r.node.write,e.nodes[n]);if(e.ways)for(n=0;n<e.ways.length;n++)t.writeMessage(6,r.way.write,e.ways[n])},r.node={},r.node.read=function(e,t){return e.readFields(r.node._readField,{id:0,lat:0,lon:0},t)},r.node._readField=function(e,t,n){1===e?t.id=n.readVarint():2===e?t.lat=n.readFloat():3===e&&(t.lon=n.readFloat())},r.node.write=function(e,t){e.id&&t.writeVarintField(1,e.id),e.lat&&t.writeFloatField(2,e.lat),e.lon&&t.writeFloatField(3,e.lon)},r.way={},r.way.read=function(e,t){return e.readFields(r.way._readField,{nodes:[]},t)},r.way._readField=function(e,t,n){1===e&&n.readPackedVarint(t.nodes)},r.way.write=function(e,t){e.nodes&&t.writePackedVarint(1,e.nodes)}},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),o=n("gBtx"),i=n.n(o),a=n("c/Tr"),s=n.n(a),c=n("AMV0"),u=n.n(c),l=n("5dBV"),f=n.n(l),d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"loader",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"12",height:"12",fill:"black"}},[t("path",{attrs:{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}}),this._v(" "),t("path",{attrs:{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}},[t("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"0.8s",repeatCount:"indefinite"}})],1)])},staticRenderFns:[]},h=n("VU/8")(null,d,!1,null,null,null).exports,p=n("woOf"),v=n.n(p),m=n("//Fk"),g=n.n(m),y=n("Zrlr"),w=n.n(y),b=n("wxAW"),x=n.n(b),_=n("fZjL"),C=n.n(_),E=n("puH/"),k=n.n(E),T=function(){function e(t){w()(this,e),k()(this),this.callback=t||Function.prototype}return x()(e,[{key:"cancel",value:function(){this.isCancelled=!0,this.fire("cancel")}},{key:"notify",value:function(e){this.isCancelled||this.callback(e)}},{key:"onCancel",value:function(e){this.on("cancel",e,this)}},{key:"offCancel",value:function(e){this.off("cancel",e)}}]),e}();function S(e,t){t||(t={});var n=void 0,r=t.progress||new T;return r.on&&r.onCancel(o),new g.a(function(i,a){n=new XMLHttpRequest,"function"==typeof r.notify&&n.addEventListener("progress",function(e){e.lengthComputable?r.notify({loaded:e.loaded,total:e.total,percent:e.loaded/e.total,lengthComputable:!0}):r.notify({loaded:e.loaded,lengthComputable:!1})},!1);n.addEventListener("load",function(){if(r.offCancel(o),!r.isCancelled)if(200===n.status){var s=n.response;"json"===t.responseType&&"string"==typeof s&&(s=JSON.parse(s)),setTimeout(function(){return i(s)},0)}else a({statusError:n.status,message:"Unexpected status code "+n.status+" when calling "+e})},!1),n.addEventListener("error",function(){a("Failed to download "+e)},!1),n.addEventListener("abort",function(){a({cancelled:!0,message:"Cancelled download of "+e})},!1),n.open(t.method||"GET",e),t.responseType&&(n.responseType=t.responseType);t.headers&&C()(t.headers).forEach(function(e){n.setRequestHeader(e,t.headers[e])});"POST"===t.method?n.send(t.body):n.send(null)});function o(){!0,n&&n.abort()}}var L=["https://overpass.kumi.systems/api/interpreter","https://overpass-api.de/api/interpreter","https://overpass.openstreetmap.ru/cgi/interpreter"];var A=n("ifoU"),F=n.n(A),R=function(){function e(){w()(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}return x()(e,[{key:"growBy",value:function(e){this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e}},{key:"addPoint",value:function(e,t){if(void 0===e)throw new Error("Point is not defined");var n=e,r=t;void 0===r&&(n=e.x,r=e.y),n<this.minX&&(this.minX=n),n>this.maxX&&(this.maxX=n),r<this.minY&&(this.minY=r),r>this.maxY&&(this.maxY=r)}},{key:"addRect",value:function(e){if(!e)throw new Error("rect is not defined");this.addPoint(e.left,e.top),this.addPoint(e.right,e.top),this.addPoint(e.left,e.bottom),this.addPoint(e.right,e.bottom)}},{key:"merge",value:function(e){e.minX<this.minX&&(this.minX=e.minX),e.minY<this.minY&&(this.minY=e.minY),e.maxX>this.maxX&&(this.maxX=e.maxX),e.maxY>this.maxY&&(this.maxY=e.maxY)}},{key:"left",get:function(){return this.minX}},{key:"top",get:function(){return this.minY}},{key:"right",get:function(){return this.maxX}},{key:"bottom",get:function(){return this.maxY}},{key:"width",get:function(){return this.maxX-this.minX}},{key:"height",get:function(){return this.maxY-this.minY}},{key:"cx",get:function(){return(this.minX+this.maxX)/2}},{key:"cy",get:function(){return(this.minY+this.maxY)/2}}]),e}(),P=n("qC7P"),B=function(){function e(){w()(this,e),this.elements=[],this.bounds=new R,this.nodes=new F.a,this.wayPointCount=0,this.id=0,this.name="",this.isArea=!0,this.projector=Object(P.a)()}return x()(e,[{key:"setName",value:function(e){this.name=e}},{key:"setId",value:function(e){this.id=e}},{key:"setIsArea",value:function(e){this.isArea=e}},{key:"setBBox",value:function(e){this.bboxString=e}},{key:"hasRoads",value:function(){return this.wayPointCount>0}},{key:"getProjectedRect",value:function(){var e=this.bounds,t=this.getProjector(),n=t({lon:e.left,lat:e.bottom}),r=t({lon:e.right,lat:e.top}),o=n.x,i=n.y,a=r.y,s=r.x;return{left:o,top:i,right:s,bottom:a,width:s-o,height:Math.abs(a-i)}}},{key:"forEachElement",value:function(e){this.elements.forEach(e)}},{key:"forEachWay",value:function(e){var t=this.nodes,n=this.getProjector();this.elements.forEach(function(r){if("way"===r.type)for(var o=r.nodes,i=n(t.get(o[0])),a=1;a<o.length;++a){var s=n(t.get(o[a]));e(i,s),i=s}})}},{key:"getProjector",value:function(){var e=[0,0],t=this.projector;return function(n){var r=n.lon,o=n.lat;e[0]=r,e[1]=o;var i=t(e);return{x:i[0],y:i[1]}}}}],[{key:"fromPBF",value:function(t){if(1!==t.version)throw new Error("Unknown version "+t.version);var n=[];t.nodes.forEach(function(e){e.type="node",n.push(e)}),t.ways.forEach(function(e){e.type="way",n.push(e)});var r=e.fromOSMResponse(n);return r.setName(t.name),r.setId(t.id),r}},{key:"fromOSMResponse",value:function(t){var n=new e,r=n.nodes,o=n.bounds,i=0;return t.forEach(function(e){"node"===e.type?(r.set(e.id,e),o.addPoint(e.lon,e.lat)):"way"===e.type&&(i+=e.nodes.length)}),n.elements=t,n.projector.center([o.cx,o.cy]).scale(6371393),n.wayPointCount=i,n}}]),e}(),I=function(){function e(t,n){w()(this,e),this.queryString=t,this.progress=n,this.promise=null}return x()(e,null,[{key:"all",value:function(t,n){return new e("[timeout:9000][maxsize:2000000000][out:json];\narea({{geocodeArea:"+n+"}});\n(._; )->.area;\n("+t+"(area.area); node(w););\nout skel;")}}]),x()(e,[{key:"run",value:function(){var e=this;if(this.promise)return this.promise;var t=function(e){var t=/{{geocodeArea:(.+?)}}/,n=void 0,r=[];for(;n=e.match(t);)r.push(e.substr(0,n.index)),r.push({type:"area",name:n[1]}),e=e.substr(n.index+n[0].length);return r.push(e),r}(this.queryString);return this.promise=function(e){var t=0;return function n(){if(t>=e.length)return g.a.resolve();var r=e[t];t+=1;if("string"==typeof r)return n();if("area"===r.type){var o=encodeURIComponent(r.name);return S("https://nominatim.openstreetmap.org/search?format=json&q="+o,{responseType:"json"}).then(z).then(D).then(function(e){if(!e)throw new Error("No areas found for request "+r.name);v()(r,e)}).then((i=1e3,function(e){return new g.a(function(t){setTimeout(function(){return t(e)},i)})})).then(n)}var i;throw new Error("Unknown part: "+r)}().then(function(){return e.map(function(e){return"string"==typeof e?e:e.areaId}).join("")})}(t).then(function(t){return function(e,t){var n={method:"POST",responseType:"json",progress:t=t||new T,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"data="+encodeURIComponent(e)},r=0;return o(L[r]);function o(e){return S(e,n).catch(i)}function i(e){if(e.cancelled)throw e;if(r>=L.length-1)throw e;return e.statusError&&t.notify({loaded:-1}),o(L[r+=1])}}(t,e.progress)}).then(function(e){return B.fromOSMResponse(e.elements)}),this.promise}}]),e}();function z(e){return e.filter(function(e){return"relation"===e.osm_type||"way"===e.osm_type}).map(function(e){var t=void 0;return"relation"===e.osm_type?t=e.osm_id+36e8:"way"===e.osm_type&&(t=e.osm_id+24e8),{areaId:t,name:e.display_name,type:e.type}})}function D(e){if(e.length>0)return e[0]}var M=n("3zJd"),O=n.n(M)()({},{useSearch:!0}),U={drawLabels:!0,get:function(){return O.get.apply(O,arguments)},set:function(){return O.set.apply(O,arguments)},unset:function(){return O.unset.apply(O,arguments)},unsetPlace:function(){O.unset("areaId"),O.unset("osm_id"),O.unset("bbox")}},N=n("YrBu"),j=n.n(N),Y={areaServer:"https://anvaka.github.io/index-large-cities/data",getDefaultLineColor:function(){return j()("rgba(26, 26, 26, 0.8)").toRgb()},getLabelColor:function(){return j()("#161616").toRgb()},getBackgroundColor:function(e){var t=j()("#F7F2E8");return e?t.toRgbString():t.toRgb()}},V={name:"FindPlace",components:{LoadingIcon:h},data:function(){var e=U.get("q")||"",t=X();return{enteredInput:e,loading:null,lastCancel:null,suggestionsLoaded:!1,boxInTheMiddle:!0,stillLoading:0,error:null,hideInput:!1,noRoads:!1,clicked:!1,showWarning:t,mainActionText:t?"Download Area":"Find City Bounds",data:[]}},watch:{enteredInput:function(){this.mainActionText="Find City Bounds",this.showWarning=!1,this.hideInput=!1,U.unsetPlace()}},mounted:function(){this.$refs.input.focus()},beforeDestroy:function(){this.lastCancel&&this.lastCancel(),clearInterval(this.notifyStillLoading)},methods:{onSubmit:function(){var e=this;U.set("q",this.enteredInput),this.cancelRequest(),this.data=[],this.noRoads=!1,this.error=!1,this.showWarning=!1;var t=X(this.enteredInput);if(t)this.pickSuggestion(t);else{var n=encodeURIComponent(this.enteredInput);this.loading="Searching cities that match your query...",S("https://nominatim.openstreetmap.org/search?format=json&q="+n,{responseType:"json"}).then(function(e){return e.map(function(e){return"relation"===e.osm_type?{name:e.display_name,type:e.type,areaId:e.osm_id+36e8}:e.boundingbox?{name:e.display_name,type:e.type,osm_id:e.osm_id,bbox:[f()(e.boundingbox[0]),f()(e.boundingbox[2]),f()(e.boundingbox[1]),f()(e.boundingbox[3])]}:void 0}).filter(function(e){return e})}).then(function(t){e.loading=null,e.hideInput=t&&t.length,e.boxInTheMiddle?(e.boxInTheMiddle=!1,setTimeout(function(){e.suggestionsLoaded=!0,e.data=t},50)):(e.suggestionsLoaded=!0,e.data=t)})}},getBugReportURL:function(e){var t=encodeURIComponent("OSM Error"),n="";return e&&(n="Hello, an error occurred on the website:\n\n```\n"+e.toString()+"\n```\n\n Can you please help?"),"https://github.com/anvaka/city-roads/issues/new?title="+t+"&body="+encodeURIComponent(n)},updateProgress:function(e){if(this.stillLoading=0,clearInterval(this.notifyStillLoading),e.loaded<0)return this.loading="Trying a different server",void this.restartLoadingMonitor();void 0!==e.percent?this.loading="Loaded "+Math.round(100*e.percent)+"% ("+q(e.loaded)+" bytes)...":this.loading="Loaded "+q(e.loaded)+" bytes..."},retry:function(){this.lastSuggestion&&this.pickSuggestion(this.lastSuggestion)},pickSuggestion:function(e){var t=this;this.lastSuggestion=e,this.error=!1,e.areaId?this.checkCache(e).catch(function(n){if(!n.cancelled)return t.useOSM(e)}):this.useOSM(e)},restartLoadingMonitor:function(){var e=this;clearInterval(this.notifyStillLoading),this.stillLoading=0,this.notifyStillLoading=setInterval(function(){e.stillLoading++},1e4)},checkCache:function(e){var t=this;this.loading="Checking cache...";var r=e.areaId;return S(Y.areaServer+"/"+r+".pbf",{progress:this.generateNewProgressToken(),responseType:"arraybuffer"}).then(function(e){return new Uint8Array(e)}).then(function(e){var r=n("/5HI"),o=n("MeRj").place,i=new r(e),a=o.read(i),s=B.fromPBF(a);t.$emit("loaded",s)})},useOSM:function(e){var t=this;if(e.areaId&&e.osm_id)throw new Error("Cannot have both area id and osm id. Pick one");this.loading="Connecting to OpenStreetMap...",this.restartLoadingMonitor();var n=function(e){var t=e.areaId;if(t)return"[timeout:900][maxsize:1073741824][out:json];\narea("+t+");\n(._; )->.area;\n(\nway[highway](area.area);\nnode(w);\n);\nout skel;";var n=W(e.bbox);return"[timeout:900][out:json][bbox:"+n+"];\n(\nway[highway];\nnode(w);\n);\nout skel("+n+");"}(e);new I(n,this.generateNewProgressToken()).run().then(function(n){t.loading=null,n.hasRoads()?(n.setName(e.name),n.setId(e.areaId||e.osm_id),n.setIsArea(e.areaId),n.setBBox(W(e.bbox)),t.$emit("loaded",n)):t.noRoads=!0}).catch(function(e){e.cancelled?t.loading=null:(console.error(e),t.error=e,t.loading=null,t.data=[])}).finally(function(){clearInterval(t.notifyStillLoading),t.stillLoading=0})},cancelRequest:function(){this.progressToken&&(this.progressToken.cancel(),this.progressToken=null,this.loading=!1)},generateNewProgressToken:function(){return this.progressToken&&(this.progressToken.cancel(),this.progressToken=null),this.progressToken=new T(this.updateProgress),this.progressToken}}};function W(e){return e&&e.join(",")}function q(e){return u()(e)?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"N/A"}function X(e){var t=function(){var e=U.get("areaId");u()(i()(e,10))||(e=null);return e}();if(t)return{name:e,areaId:t};var n=function(){var e=U.get("osm_id");if(!u()(i()(e,10)))return;var t=function(e){if(!e)return null;var t=e.split(",").map(function(e){return f()(e)}).filter(function(e){return u()(e)});return 4===t.length?t:null}(U.get("bbox"));if(!t)return;return{osm_id:e,bbox:t}}();return n?{name:e,osm_id:n.osm_id,bbox:n.bbox}:void 0}var G={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"find-place",class:{centered:e.boxInTheMiddle}},[e.boxInTheMiddle?n("div",[n("h3",{staticClass:"site-header"},[e._v("city roads")]),e._v(" "),n("p",{staticClass:"description"},[e._v("This website renders every single road within a city")])]):e._e(),e._v(" "),n("form",{staticClass:"search-box",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.enteredInput,expression:"enteredInput"}],ref:"input",staticClass:"query-input",attrs:{type:"text",placeholder:"Enter a city name to start"},domProps:{value:e.enteredInput},on:{input:function(t){t.target.composing||(e.enteredInput=t.target.value)}}}),e._v(" "),e.enteredInput&&!e.hideInput?n("a",{staticClass:"search-submit",attrs:{type:"submit",href:"#"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e.mainActionText))]):e._e()]),e._v(" "),e.showWarning?n("div",{staticClass:"prompt message note shadow"},[e._v("\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\n  ")]):e._e(),e._v(" "),e.loading?e._e():n("div",{staticClass:"results"},[e.suggestionsLoaded&&e.data.length?n("div",{staticClass:"suggestions shadow"},[e._m(0),e._v(" "),n("ul",e._l(e.data,function(t,r){return n("li",{key:r},[n("a",{staticClass:"suggestion",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),e.pickSuggestion(t)}}},[n("span",[e._v("\n          "+e._s(t.name)+" "),n("small",[e._v("("+e._s(t.type)+")")])])])])}),0)]):e._e(),e._v(" "),!e.suggestionsLoaded||e.data.length||e.loading||e.error?e._e():n("div",{staticClass:"no-results message shadow"},[e._v("\n      Didn't find matching cities. Try a different query?\n    ")]),e._v(" "),e.noRoads?n("div",{staticClass:"no-results message shadow"},[e._v("\n      Didn't find any roads. Try a different query?\n    ")]):e._e()]),e._v(" "),e.error?n("div",{staticClass:"error message shadow"},[n("div",[e._v("Sorry, we were not able to download data from the OpenStreetMap.\n    It could be very busy at the moment processing other requests. "),n("br"),n("br"),e._v(" Please bookmark this website and "),n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.retry(t)}}},[e._v("try again")]),e._v(" later?")]),e._v(" "),n("div",{staticClass:"error-links"},[n("a",{attrs:{href:"https://twitter.com/anvaka/status/1218971717734789120",title:"see what it supposed to do",target:"_blank"}},[e._v("see how it should have worked")]),e._v(" "),n("a",{attrs:{href:e.getBugReportURL(e.error),title:"report error: "+e.error,target:"_blank"}},[e._v("report this bug")])])]):e._e(),e._v(" "),e.loading?n("div",{staticClass:"loading message shadow"},[n("loading-icon"),e._v(" "),n("span",[e._v(e._s(e.loading))]),e._v(" "),n("a",{staticClass:"cancel-request",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.cancelRequest(t)}}},[e._v("cancel")]),e._v(" "),e.stillLoading>0?n("div",{staticClass:"load-padding"},[e._v("\n      Still loading...\n    ")]):e._e(),e._v(" "),e.stillLoading>1?n("div",{staticClass:"load-padding"},[e._v("\n      Sorry it takes so long!\n    ")]):e._e()],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"prompt message"},[t("div",[this._v("Select boundaries below to download all roads within")]),this._v(" "),t("div",{staticClass:"note"},[this._v("large cities may require 200MB+ of data transfer and a powerful device")])])}]};var H=n("VU/8")(V,G,!1,function(e){n("F4A/")},null,null).exports,$=[],Z="@@clickoutsideContext",K=void 0,J=0;function Q(e,t,n){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n&&n.context&&r.target&&o.target&&!e.contains(r.target)&&!e.contains(o.target)&&e!==r.target&&(!n.context.popperElm||!n.context.popperElm.contains(r.target)&&!n.context.popperElm.contains(o.target))){var i=e[Z].methodName;t.expression&&i&&n.context[i]?n.context[i]():e[Z].bindingFn&&e[Z].bindingFn()}}}document.addEventListener("mousedown",function(e){return K=e},!0),document.addEventListener("mouseup",function(e){$.forEach(function(t){return t[Z].documentHandler(e,K)})},!0),document.addEventListener("touchstart",function(e){K=e},!0),document.addEventListener("touchend",function(e){$.forEach(function(t){return t[Z].documentHandler(e,K)})},!0);var ee={bind:function(e,t,n){$.push(e);var r=J++;e[Z]={id:r,documentHandler:Q(e,t,n),methodName:t.expression,bindingFn:t.value}},update:function(e,t,n){e[Z].documentHandler=Q(e,t,n),e[Z].methodName=t.expression,e[Z].bindingFn=t.value},unbind:function(e){for(var t=$.length,n=0;n<t;n++)if($[n][Z].id===e[Z].id){$.splice(n,1);break}delete e[Z]}},te={name:"EditableLabel",props:["value","printable"],directives:{ClickOutside:ee},methods:{looseFocus:function(){this.$refs.input.blur()}}},ne={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.looseFocus,expression:"looseFocus"}]},[n("div",{staticClass:"editable-label"},[n("span",{class:{printable:e.printable}},[e._v(e._s(e.value))]),e._v(" "),n("input",{ref:"input",domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])])},staticRenderFns:[]};var re=n("VU/8")(te,ne,!1,function(e){n("+syb")},null,null).exports,oe=n("Zzkc"),ie={name:"vue-colorpicker",components:{"sketch-picker":oe.Sketch},directives:{ClickOutside:ee},props:{value:{type:Object}},data:function(){return{showPicker:!1,colors:{hex:"#FFFFFF",a:1},colorValue:"#FFFFFF",panelLeft:"0px",panelTop:"0px"}},computed:{pickerType:function(){return"sketch-picker"},isTransparent:function(){return 0===this.colors.a},btnStyle:function(){if(this.isTransparent)return{background:"#eee",backgroundImage:"linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)",backgroundPosition:"0 0, 11px 11px",backgroundSize:"22px 22px"};var e=this.colorValue;return{background:"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}}},watch:{value:function(e,t){e!==t&&this.updateColorObject(e)},showPicker:function(e){if(e){var t=this.$refs.triggerButton.getBoundingClientRect(),n=t.x,r=t.bottom;t.y+320>window.innerHeight&&(r=Math.max(0,window.innerHeight-320),n+=36),n+220>window.innerWidth&&(n=Math.max(0,window.innerWidth-220)),this.panelLeft=n+"px",this.panelTop=r+"px"}}},methods:{hide:function(){this.showPicker=!1},changeColor:function(e){this.colorValue=e.rgba,this.$emit("input",this.colorValue),this.$emit("change",this.colorValue)},updateColorObject:function(e){if(e){var t=j()("rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"||"transparent");this.colors=e&&"transparent"!==e?{hex:t.toHexString(),hsl:t.toHsl(),hsv:t.toHsv(),rgba:t.toRgb(),a:t.getAlpha()}:{hex:"#FFFFFF",hsl:{h:0,s:0,l:1,a:0},hsv:{h:0,s:0,v:1,a:0},rgba:{r:255,g:255,b:255,a:0},a:0},this.colorValue=this.colors.rgba}}},mounted:function(){this.updateColorObject(this.value)}},ae={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hide,expression:"hide"}],staticClass:"vue-colorpicker",on:{click:function(t){e.showPicker=!0}}},[n("span",{ref:"triggerButton",staticClass:"vue-colorpicker-btn",style:e.btnStyle}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPicker,expression:"showPicker"}],staticClass:"vue-colorpicker-panel",style:{left:e.panelLeft,top:e.panelTop}},[n(e.pickerType,{tag:"component",on:{input:e.changeColor},model:{value:e.colors,callback:function(t){e.colors=t},expression:"colors"}})],1)])},staticRenderFns:[]};var se=n("VU/8")(ie,ae,!1,function(e){n("om41")},"data-v-60c70430",null).exports,ce=new r.a,ue=n("TzaH");function le(e){var t=ue.scene(e);t.on("transform",function(){ce.$emit("scene-transform")}),t.setClearColor(247/255,242/255,232/255,1);var n=!1,r=[];return document.addEventListener("keydown",o,!0),document.addEventListener("keyup",i,!0),{render:function(){t.renderFrame(!0)},clear:function(){r.forEach(function(e){return e.destroy()}),t.clear()},getLayers:function(){return r},dispose:function(){t.clear(),t.dispose(),document.removeEventListener("keydown",o,!0),document.removeEventListener("keyup",i,!0)},setLineColor:function(e){r.forEach(function(t){t.color=e})},setBackground:function(e){t.setClearColor(e.r/255,e.g/255,e.b/255,e.a),t.renderFrame()},add:function(e){if(!(r.indexOf(e)>-1)&&(e.bindToScene(t),r.push(e),1===r.length)){var n=e.getViewBox();t.setViewBox(n)}},getProjectedVisibleRect:function(){var e=t.getSceneCoordinate(0,0),n=t.getSceneCoordinate(window.innerWidth,window.innerHeight),r={left:e.x,top:e.y,right:n.x,bottom:n.y};return r.width=r.right-r.left,r.height=r.bottom-r.top,r}};function o(e){e.shiftKey&&(n=!0,t.getPanzoom().setZoomSpeed(.1))}function i(e){!e.shiftKey&&n&&(t.getPanzoom().setZoomSpeed(1),n=!1)}}var fe=n("TzaH"),de=0,he=function(){function e(){w()(this,e),this._color=Y.getDefaultLineColor(),this.grid=null,this.lines=null,this.scene=null,this.dx=0,this.dy=0,this.scale=1,this.id="paths_"+de,de+=1}return x()(e,[{key:"color",get:function(){return this._color},set:function(e){var t=j()(e);this._color=t,this.lines&&(this.lines.color=pe(t.toRgb())),this.scene&&this.scene.renderFrame()}}]),x()(e,[{key:"setGrid",value:function(e){this.grid=e,this.scene&&this.bindToScene(this.scene)}},{key:"getViewBox",value:function(){if(!this.grid)return null;var e=this.grid.getProjectedRect(),t=e.width,n=e.height,r=Math.max(t,n)/4;return{left:-r,top:-r,right:r,bottom:r}}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.dx=e,this.dy=t,this._transferTransform()}},{key:"moveBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.dx+=e,this.dy+=t,this._transferTransform()}},{key:"getLinesCollection",value:function(){if(this.lines)return this.lines;var e=this.grid,t=void 0;t=new fe.WireCollection(e.wayPointCount),e.forEachWay(function(e,n){t.add({from:e,to:n})});var n=j()(this._color).toRgb();return t.color=pe(n),this.lines=t,t}},{key:"destroy",value:function(){this.scene&&this.lines&&this.scene.removeChild(this.lines)}},{key:"bindToScene",value:function(e){if(this.scene&&this.lines&&console.error("You seem to be adding this layer twice..."),this.scene=e,this.grid){var t=this.getLinesCollection();this.scene.appendChild(t)}}},{key:"_transferTransform",value:function(){this.lines&&(this.lines.transform.dx=this.dx,this.lines.transform.dy=this.dy,this.lines.transform.scale=this.scale,this.lines.updateWorldTransform(!0),this.scene&&this.scene.renderFrame(!0))}}]),e}();function pe(e){return{r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}}var ve="https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image",me={mug:"168739066664861503"};function ge(e){var t=e.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,""),n=new FormData;return n.append("image",t),S(ve,{method:"POST",responseType:"json",progress:new T(Function.prototype),body:n}).then(function(e){if(!e.success)throw new Error("Failed to upload image");return function(e,t){var n=me[e];if(!n)throw new Error("Unknown product kind: "+e);return"https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd="+n+"&ed=true&tc=&ic=&t_map_iid="+encodeURIComponent(t)}("mug",e.data.link)}).catch(function(e){throw console.log("error",e),e})}var ye=n("LVrL"),we=n.n(ye),be=n("kfvp"),xe=n.n(be),_e=(n("YzTF"),void 0),Ce={name:"App",components:{FindPlace:H,LoadingIcon:h,EditableLabel:re,ColorPicker:se},data:function(){return{placeFound:!1,name:"",zazzleLink:null,generatingPreview:!1,showPrintWindow:!1,settingsOpen:!1,lineColor:Y.getDefaultLineColor(),labelColor:Y.getLabelColor(),backgroundColor:Y.getBackgroundColor()}},computed:{labelColorRGBA:function(){return ke(this.labelColor)}},created:function(){ce.$on("scene-transform",this.handleSceneTransform)},beforeDestroy:function(){this.dispose(),ce.$off("scene-transform",this.handleSceneTransform)},methods:{dispose:function(){this.scene&&(this.scene.dispose(),window.scene=null)},togglePrintWindow:function(){this.showPrintWindow=!this.showPrintWindow},handleSceneTransform:function(){this.zazzleLink=null},onGridLoaded:function(e){e.isArea?(U.set("areaId",e.id),U.unset("osm_id"),U.unset("bbox")):e.bboxString&&(U.unset("areaId"),U.set("osm_id",e.id),U.set("bbox",e.bboxString)),this.placeFound=!0,this.name=e.name.split(",")[0],_e=e;var t=Te();t.style.visibility="visible",this.scene=le(t),window.scene=this.scene;var n=new he;n.id="roads",n.setGrid(e),this.scene.add(n)},startOver:function(){U.unset("areaId"),U.unsetPlace(),U.unset("q"),this.dispose(),this.placeFound=!1,this.zazzleLink=null,this.showPrintWindow=!1,this.backgroundColor=Y.getBackgroundColor(),this.lineColor=Y.getDefaultLineColor(),this.labelColor=Y.getLabelColor(),document.body.style.backgroundColor=Y.getBackgroundColor(!0),Te().style.visibility="hidden"},toPNGFile:function(e){var t=this.getPrintableCanvas(),n=this.getFileName();t.toBlob(function(e){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=n+".png",r.click(),window.URL.revokeObjectURL(t)},"image/png")},toSVGFile:function(e){var t=this.scene.getProjectedVisibleRect(),n=this.scene.getLayers(),r=xe()(n,t,{stroke:Se(this.lineColor),background:Se(this.backgroundColor),labels:Ee()}),o=new Blob([r],{type:"image/svg+xml"}),i=window.URL.createObjectURL(o);setTimeout(function(){var e=document.createElement("a");e.href=i,e.download=_e.id+".svg",e.click(),window.URL.revokeObjectURL(i)},30)},getFileName:function(e){return(new Date).toISOString().replace(/[\s\W]/g,"_")+(e||"")},toProtobuf:function(e){if(_e){var t=we()(_e),n=new Blob([t.buffer],{type:"application/octet-stream"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=_e.id+".pbf",o.click(),window.URL.revokeObjectURL(r)}},updateLinesColor:function(){this.scene.setLineColor(this.lineColor),this.zazzleLink=null},updateBackground:function(){this.setBackgroundColor(this.backgroundColor),this.zazzleLink=null},setBackgroundColor:function(e){this.scene.setBackground(e),document.body.style.backgroundColor=ke(e),this.zazzleLink=null},zazzleMugPrint:function(){var e=this;if(this.zazzleLink)return window.open(this.zazzleLink,"_blank"),void Ae(this.zazzleLink);var t=this.getPrintableCanvas();this.generatingPreview=!0,ge(t).then(function(t){e.zazzleLink=t,window.open(t,"_blank"),Ae(t),e.generatingPreview=!1}).catch(function(t){e.error=t,e.generatingPreview=!1})},getPrintableCanvas:function(){var e=Te(),t=e.width,n=e.height,r=document.createElement("canvas"),o=r.getContext("2d");return r.width=t,r.height=n,this.scene.render(),o.drawImage(e,0,0,e.width,e.height,0,0,t,n),U.drawLabels&&Ee().forEach(function(e){!function(e,t){if(!e)return;t.save();var n=window.devicePixelRatio||1;t.font=n*e.fontSize+"px "+e.fontFamily,t.fillStyle=e.color,t.textAlign="end",t.fillText(e.text,e.bounds.right*n,e.bounds.bottom*n),t.restore()}(e,o)}),r}}};function Ee(){return s()(document.querySelectorAll(".printable")).map(function(e){var t=window.getComputedStyle(e),n=e.getBoundingClientRect(),r=i()(t.fontSize,10);return{text:e.innerText,bounds:n,fontSize:r,color:t.color,fontFamily:t.fontFamily,fill:t.color}})}function ke(e){return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}function Te(){return document.querySelector("#canvas")}function Se(e){return"#"+Le(e.r)+Le(e.g)+Le(e.b)}function Le(e){if(0===e)return"00";var t=e.toString(16);return e<16?"0"+t:t}function Ae(e){"undefined"!=typeof ga&&ga("send","event",{eventCategory:"Outbound Link",eventAction:"click",eventLabel:e})}var Fe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.placeFound?e._e():n("find-place",{on:{loaded:e.onGridLoaded}}),e._v(" "),n("div",{attrs:{id:"app"}},[e.placeFound?n("div",[n("div",{staticClass:"controls"},[n("a",{staticClass:"print-button",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.togglePrintWindow(t)}}},[e._v("Customize...")]),e._v(" "),n("a",{staticClass:"try-another",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.startOver(t)}}},[e._v("Try another city")])]),e._v(" "),e.showPrintWindow?n("div",{staticClass:"print-window"},[n("h3",[e._v("Display")]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[e._v("Colors")]),e._v(" "),n("div",{staticClass:"col colors c-2"},[n("div",{staticClass:"color-container"},[n("color-picker",{on:{change:e.updateLinesColor},model:{value:e.lineColor,callback:function(t){e.lineColor=t},expression:"lineColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("lines")])],1),e._v(" "),n("div",{staticClass:"color-container"},[n("color-picker",{on:{change:e.updateBackground},model:{value:e.backgroundColor,callback:function(t){e.backgroundColor=t},expression:"backgroundColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("background")])],1),e._v(" "),n("div",{staticClass:"color-container"},[n("color-picker",{model:{value:e.labelColor,callback:function(t){e.labelColor=t},expression:"labelColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("labels")])],1)])]),e._v(" "),n("h3",[e._v("Export")]),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.zazzleMugPrint()}}},[e._v("Onto a mug")]),e._v(" "),e._m(0)]),e._v(" "),e.zazzleLink||e.generatingPreview?n("div",{staticClass:"preview-actions message"},[e.zazzleLink?n("div",{staticClass:"padded popup-help"},[e._v("\n              If your browser has blocked the new window, "),n("br"),e._v("please "),n("a",{attrs:{href:e.zazzleLink,target:"_blank"}},[e._v("click here")]),e._v("\n              to open it.\n            ")]):e._e(),e._v(" "),e.generatingPreview?n("div",{staticClass:"loading-container"},[n("loading-icon"),e._v("\n              Generating preview url...\n            ")],1):e._e()]):e._e(),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.toPNGFile(t)}}},[e._v("As an image (.png)")]),e._v(" "),n("span",{staticClass:"col c-2"},[e._v("\n            Save the current screen as a raster image.\n          ")])]),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.toSVGFile(t)}}},[e._v("As a vector (.svg)")]),e._v(" "),n("span",{staticClass:"col c-2"},[e._v("\n            Save the current screen as a vector image.\n          ")])]),e._v(" "),e._e(),e._v(" "),n("h3",[e._v("About")]),e._v(" "),e._m(1)]):e._e(),e._v(" "),n("editable-label",{staticClass:"city-name",style:{color:e.labelColorRGBA},attrs:{printable:!0},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("div",{staticClass:"license printable",style:{color:e.labelColorRGBA}},[e._v("data "),n("a",{style:{color:e.labelColorRGBA},attrs:{href:"https://www.openstreetmap.org/about/",target:"_blank"}},[e._v("Â© OpenStreetMap")])])],1):e._e()])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"col c-2"},[this._v("\n            Print what you see onto a mug. "),t("br"),this._v("Get a unique gift of your favorite city.\n          ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("This website was created by "),n("a",{attrs:{href:"https://twitter.com/anvaka",target:"_blank"}},[e._v("@anvaka")]),e._v(".\n          It downloads roads from OpenStreetMap and renders them with WebGL.\n          ")]),e._v(" "),n("p",[e._v("\n           You can find the entire "),n("a",{attrs:{href:"https://github.com/anvaka/city-roads"}},[e._v("source code here")]),e._v(". \n           If you love this website you can also "),n("a",{attrs:{href:"https://www.paypal.com/paypalme2/anvakos/3"}},[e._v("buy me a coffee")]),e._v(", but you don't have to!\n          ")])])}]};var Re=n("VU/8")(Ce,Fe,!1,function(e){n("z3MC")},null,null).exports,Pe={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute no-webgl"},[n("h3",[e._v("WebGL is not enabled :(")]),e._v(" "),n("p",[e._v("This website renders millions of roads at once.")]),e._v(" "),n("p",[e._v("\n    To render this amount of data fast, the website uses "),n("a",{attrs:{href:"https://get.webgl.org/"}},[e._v("WebGL")]),e._v(",\n    which seem to be not supported by the device that you are using.\n  ")]),e._v(" "),n("p",[e._v("Please try a different device to play with this website")]),e._v(" "),n("img",{attrs:{src:"https://i.imgur.com/Fbbe5a6.png",alt:"demo"}})])}]};var Be=n("VU/8")(null,Pe,!1,function(e){n("tvtY")},"data-v-4c133b01",null).exports;var Ie=n("TzaH");window.addEventListener("error",function(e){if("function"!=typeof ga)return;var t=e?e.message+" in "+e.filename+":"+e.lineno:"Unknown exception";ga("send","exception",{exDescription:t,exFatal:!1})}),r.a.config.productionTip=!1,window.load=function(e,t){var n=new he;return n.query=I.all(e,t),n.query.run().then(function(e){n.setGrid(e)}).catch(function(t){console.error("Could not execute:\n"+e+"\nThe error was:"),console.error(t),n.destroy()}),void 0!==window.scene&&window.scene.add(n),n},Ie.isWebGLEnabled(document.querySelector("#canvas"))?new r.a({el:"#app",components:{App:Re},template:"<App/>"}):new r.a({el:"#app",components:{NoWebGL:Be},template:"<NoWebGL/>"})},TzaH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){n.d(t,"scene",function(){return Q}),n.d(t,"PointCollection",function(){return pe}),n.d(t,"Point",function(){return ve}),n.d(t,"LineCollection",function(){return _e}),n.d(t,"WireCollection",function(){return Ee}),n.d(t,"LineStripCollection",function(){return Se}),n.d(t,"Element",function(){return K}),n.d(t,"isWebGLEnabled",function(){return Le}),n.d(t,"utils",function(){return ee});
/*!
 * wgl v0.7.4
 * (c) 2017 Andrei Kashcha.
 * Released under the MIT License.
 */
var r=a,o=a,i=function(e,t,n){e.removeEventListener("wheel",t,n)};function a(e,t,n){e.addEventListener("wheel",t,n)}r.addWheelListener=o,r.removeWheelListener=i;var s=4,c=.001,u=1e-7,l=10,f=11,d=1/(f-1),h="function"==typeof Float32Array;function p(e,t){return 1-3*t+3*e}function v(e,t){return 3*t-6*e}function m(e){return 3*e}function g(e,t,n){return((p(t,n)*e+v(t,n))*e+m(t))*e}function y(e,t,n){return 3*p(t,n)*e*e+2*v(t,n)*e+m(t)}function w(e){return e}var b=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return w;for(var o=h?new Float32Array(f):new Array(f),i=0;i<f;++i)o[i]=g(i*d,e,n);function a(t){for(var r=0,i=1,a=f-1;i!==a&&o[i]<=t;++i)r+=d;var h=r+(t-o[--i])/(o[i+1]-o[i])*d,p=y(h,e,n);return p>=c?function(e,t,n,r){for(var o=0;o<s;++o){var i=y(t,n,r);if(0===i)return t;t-=(g(t,n,r)-e)/i}return t}(t,h,e,n):0===p?h:function(e,t,n,r,o){var i,a,s=0;do{(i=g(a=t+(n-t)/2,r,o)-e)>0?n=a:t=a}while(Math.abs(i)>u&&++s<l);return a}(t,r,r+d,e,n)}return function(e){return 0===e?0:1===e?1:g(a(e),t,r)}},x={ease:b(.25,.1,.25,1),easeIn:b(.42,0,1,1),easeOut:b(0,0,.58,1),easeInOut:b(.42,0,.58,1),linear:b(0,0,1,1)},_=function(e,t,n){var r=Object.create(null),o=Object.create(null),i="function"==typeof(n=n||{}).easing?n.easing:x[n.easing];i||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),i=x.ease);var a="function"==typeof n.step?n.step:k,s="function"==typeof n.done?n.done:k,c=function(e){if(!e){var t="undefined"!=typeof window&&window.requestAnimationFrame;return t?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),u=Object.keys(t);u.forEach(function(n){r[n]=e[n],o[n]=t[n]-e[n]});var l,f="number"==typeof n.duration?n.duration:400,d=Math.max(1,.06*f),h=0;return l=c.next(function t(){var n=i(h/d);h+=1,function(t){u.forEach(function(n){e[n]=o[n]*t+r[n]})}(n),h<=d?(l=c.next(t),a(e)):(l=0,setTimeout(function(){s(e)},0))}),{cancel:function(){c.cancel(l),l=0}}},C=T,E=T();function k(){}function T(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(o))}function o(){n=0;var r=t;t=e,(e=r).forEach(function(e){e()}),e.clear()}}_.makeAggregateRaf=C,_.sharedScheduler=E;var S=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=t[n];return i||(i=t[n]=[]),i.push({callback:r,ctx:o}),e},off:function(n,r){var o=void 0===n;if(o)return t=Object.create(null),e;if(t[n]){var i="function"!=typeof r;if(i)delete t[n];else for(var a=t[n],s=0;s<a.length;++s)a[s].callback===r&&a.splice(s,1)}return e},fire:function(n){var r,o=t[n];if(!o)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<o.length;++i){var a=o[i];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};var L="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},A=function(e,t,n){"object"!=typeof n&&(n={});var r,o,i,a,s,c,u,l,f,d,h="number"==typeof n.minVelocity?n.minVelocity:5,p="number"==typeof n.amplitude?n.amplitude:.25,v="function"==typeof n.cancelAnimationFrame?n.cancelAnimationFrame:function(){if("function"==typeof L.cancelAnimationFrame)return L.cancelAnimationFrame;return clearTimeout}(),m="function"==typeof n.requestAnimationFrame?n.requestAnimationFrame:function(){if("function"==typeof L.requestAnimationFrame)return L.requestAnimationFrame;return function(e){return setTimeout(e,16)}}(),g=342;return{start:function(){r=e(),c=f=a=u=0,o=new Date,v(i),v(d),i=m(y)},stop:function(){v(i),v(d);var t=e();s=t.x,l=t.y,o=Date.now(),(a<-h||a>h)&&(s+=c=p*a);(u<-h||u>h)&&(l+=f=p*u);d=m(w)},cancel:function(){v(i),v(d)}};function y(){var t=Date.now(),n=t-o;o=t;var s=e(),c=s.x-r.x,l=s.y-r.y;r=s;var f=1e3/(1+n);a=.8*c*f+.2*a,u=.8*l*f+.2*u,i=m(y)}function w(){var e=Date.now()-o,n=!1,r=0,i=0;c&&((r=-c*Math.exp(-e/g))>.5||r<-.5?n=!0:r=c=0),f&&((i=-f*Math.exp(-e/g))>.5||i<-.5?n=!0:i=f=0),n&&(t(s+r,l+i),d=m(w))}};var F=function(e){if(e)return{capture:P,release:P};var t,n,r,o=!1;return{capture:function(e){o=!0,n=window.document.onselectstart,r=window.document.ondragstart,window.document.onselectstart=R,(t=e).ondragstart=R},release:function(){if(!o)return;o=!1,window.document.onselectstart=n,t&&(t.ondragstart=r)}}};function R(e){return e.stopPropagation(),!1}function P(){}var B=function(){this.x=0,this.y=0,this.scale=1};var I=function(e,t){if(!(e instanceof SVGElement))throw new Error("svg element is required for svg.panzoom to work");var n=e.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){var e=n.getCTM();if(!e)return n.getScreenCTM();return e},getOwner:function(){return n},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var r=e.getCTM();t.x=r.e,t.y=r.f,t.scale=r.a,n.removeAttributeNS(null,"viewBox")}}};var z=function(e,t){if(!(e instanceof HTMLElement))throw new Error("svg element is required for svg.panzoom to work");var n=e.parentElement;if(!n)throw new Error("Do not apply panzoom to the detached DOM element. ");e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0);return{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return n},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}};var D=F(),M=F(!0),O=1,U=1.75,N=300,j=Y;function Y(e,t){var n=(t=t||{}).controller;if(n||(e instanceof SVGElement&&(n=I(e,t)),e instanceof HTMLElement&&(n=z(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var o=n.getOwner(),i={x:0,y:0},a=!1,s=new B;n.initTransform&&n.initTransform(s);var c,u="function"==typeof t.filterKey?t.filterKey:q,l="number"==typeof t.pinchSpeed?t.pinchSpeed:1,f=t.bounds,d="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,h="number"==typeof t.minZoom?t.minZoom:0,p="number"==typeof t.boundsPadding?t.boundsPadding:.05,v="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:U,m=t.beforeWheel||q,g=t.beforeMouseDown||q,y="number"==typeof t.zoomSpeed?t.zoomSpeed:O,w=V(t.transformOrigin),b=t.enableTextSelection?M:D;!function(e){var t=typeof e;if("undefined"===t||"boolean"===t)return;if(!(X(e.left)&&X(e.top)&&X(e.bottom)&&X(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(f),t.autocenter&&function(){var e,t,r=0,i=0,a=J();if(a)r=a.left,i=a.top,e=a.right-a.left,t=a.bottom-a.top;else{var c=o.getBoundingClientRect();e=c.width,t=c.height}var u=n.getBBox();if(0===u.width||0===u.height)return;var l=t/u.height,f=e/u.width,d=Math.min(f,l);s.x=-(u.left+u.width/2)*d+e/2+r,s.y=-(u.top+u.height/2)*d+t/2+i,s.scale=d}();var x,C,E,k,T,L,F,R=0,P=!1,j=!1;k="smoothScroll"in t&&!t.smoothScroll?{start:q,stop:q,cancel:q}:A(function(){return{x:s.x,y:s.y}},function(e,t){Ce(),$(e,t)},t.smoothScroll);var Y=!1;re();var W={dispose:function(){oe()},moveBy:ne,moveTo:$,centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,o=n.top+n.height/2,i=t.getBoundingClientRect(),a=i.width/2-r,s=i.height/2-o;ne(a,s,!0)},zoomTo:_e,zoomAbs:te,smoothZoom:be,smoothZoomAbs:function(e,t,n){var r={scale:s.scale},o={scale:n};k.cancel(),Ce(),L=_(r,o,{step:function(n){te(e,t,n.scale)}})},showRectangle:function(e){var t=o.getBoundingClientRect(),n=H(t.width,t.height),r=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("Invalid rectangle");var a=n.x/r,c=n.y/i,u=Math.min(a,c);s.x=-(e.left+r/2)*u+n.x/2,s.y=-(e.top+i/2)*u+n.y/2,s.scale=u},pause:function(){oe(),Y=!0},resume:function(){Y&&(re(),Y=!1)},isPaused:function(){return Y},getTransform:function(){return s},getMinZoom:function(){return h},getMaxZoom:function(){return d},getTransformOrigin:function(){return w},setTransformOrigin:function(e){w=V(e)},getZoomSpeed:function(){return y},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");y=e}};return S(W),W;function H(e,t){if(n.getScreenCTM){var r=n.getScreenCTM(),o=r.a,a=r.d,s=r.e,c=r.f;i.x=e*o-s,i.y=t*a-c}else i.x=e,i.y=t;return i}function $(e,t){s.x=e,s.y=t,K(),Le("pan"),Q()}function Z(e,t){$(s.x+e,s.y+t)}function K(){var e=J();if(e){var t,r,o,i,a=!1,c=(t=n.getBBox(),o=t.left,i=t.top,{left:(r={x:o*s.scale+s.x,y:i*s.scale+s.y}).x,top:r.y,right:t.width*s.scale+r.x,bottom:t.height*s.scale+r.y}),u=e.left-c.right;return u>0&&(s.x+=u,a=!0),(u=e.right-c.left)<0&&(s.x+=u,a=!0),(u=e.top-c.bottom)>0&&(s.y+=u,a=!0),(u=e.bottom-c.top)<0&&(s.y+=u,a=!0),a}}function J(){if(f){if("boolean"==typeof f){var e=o.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*p,top:n*p,right:t*(1-p),bottom:n*(1-p)}}return f}}function Q(){a=!0,c=window.requestAnimationFrame(ie)}function ee(e,t,n){if(G(e)||G(t)||G(n))throw new Error("zoom requires valid numbers");var r=s.scale*n;if(r<h){if(s.scale===h)return;n=h/s.scale}if(r>d){if(s.scale===d)return;n=d/s.scale}var o=H(e,t);(s.x=o.x-n*(o.x-s.x),s.y=o.y-n*(o.y-s.y),f&&1===p&&1===h)?(s.scale*=n,K()):K()||(s.scale*=n);Le("zoom"),Q()}function te(e,t,n){ee(e,t,n/s.scale)}function ne(e,t,n){if(!n)return Z(e,t);T&&T.cancel();var r=0,o=0;T=_({x:0,y:0},{x:e,y:t},{step:function(e){Z(e.x-r,e.y-o),r=e.x,o=e.y}})}function re(){o.addEventListener("mousedown",he,{passive:!1}),o.addEventListener("dblclick",de,{passive:!1}),o.addEventListener("touchstart",se,{passive:!1}),o.addEventListener("keydown",ae,{passive:!1}),r.addWheelListener(o,ye,{passive:!1}),Q()}function oe(){r.removeWheelListener(o,ye),o.removeEventListener("mousedown",he),o.removeEventListener("keydown",ae),o.removeEventListener("dblclick",de),o.removeEventListener("touchstart",se),c&&(window.cancelAnimationFrame(c),c=0),k.cancel(),me(),ge(),b.release(),Te()}function ie(){a&&(a=!1,n.applyTransform(s),Le("transform"),c=0)}function ae(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),!u(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var i=o.getBoundingClientRect();ne(.05*(a=Math.min(i.width,i.height))*t,.05*a*n)}if(r){var a,s=Ee(100*r);_e((a=w?xe():{x:(c=o.getBoundingClientRect()).width/2,y:c.height/2}).x,a.y,s)}var c}}function se(e){if(function(e){if(t.onTouch&&!t.onTouch(e))return;e.stopPropagation(),e.preventDefault()}(e),1===e.touches.length)return function(e){var t=we(e.touches[0]);x=t.x,C=t.y,k.cancel(),ce()}(e,e.touches[0]);2===e.touches.length&&(E=fe(e.touches[0],e.touches[1]),F=!0,ce())}function ce(){P||(P=!0,document.addEventListener("touchmove",ue),document.addEventListener("touchend",le),document.addEventListener("touchcancel",le))}function ue(e){if(1===e.touches.length){e.stopPropagation();var t=H((f=we(e.touches[0])).x,f.y),n=t.x-x,r=t.y-C;0!==n&&0!==r&&ke(),x=t.x,C=t.y,ne(n,r)}else if(2===e.touches.length){F=!0;var o=e.touches[0],i=e.touches[1],a=fe(o,i),s=1+(a/E-1)*l,c=we(o),u=we(i);if(x=(c.x+u.x)/2,C=(c.y+u.y)/2,w){var f=xe();x=f.x,C=f.y}_e(x,C,s),E=a,e.stopPropagation(),e.preventDefault()}}function le(e){if(e.touches.length>0){var t=we(e.touches[0]);x=t.x,C=t.y}else{var n=new Date;if(n-R<N)if(w)be((t=xe()).x,t.y,v);else be(x,C,v);R=n,P=!1,Te(),ge()}}function fe(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function de(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=we(e);w&&(n=xe()),be(n.x,n.y,v)}function he(e){if(!g(e)){if(P)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){k.cancel();var t=we(e),n=H(t.x,t.y);return x=n.x,C=n.y,document.addEventListener("mousemove",pe),document.addEventListener("mouseup",ve),b.capture(e.target||e.srcElement),!1}}}function pe(e){if(!P){ke();var t=we(e),n=H(t.x,t.y),r=n.x-x,o=n.y-C;x=n.x,C=n.y,ne(r,o)}}function ve(){b.release(),Te(),me()}function me(){document.removeEventListener("mousemove",pe),document.removeEventListener("mouseup",ve),j=!1}function ge(){document.removeEventListener("touchmove",ue),document.removeEventListener("touchend",le),document.removeEventListener("touchcancel",le),j=!1,F=!1}function ye(e){if(!m(e)){k.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=Ee(t);if(1!==n){var r=w?xe():we(e);_e(r.x,r.y,n),e.preventDefault()}}}function we(e){var t=o.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function be(e,t,n){var r=s.scale,o={scale:r},i={scale:n*r};k.cancel(),Ce(),L=_(o,i,{step:function(n){te(e,t,n.scale)},done:Se})}function xe(){var e=o.getBoundingClientRect();return{x:e.width*w.x,y:e.height*w.y}}function _e(e,t,n){return k.cancel(),Ce(),ee(e,t,n)}function Ce(){L&&(L.cancel(),L=null)}function Ee(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(y*e/128))}function ke(){j||(Le("panstart"),j=!0,k.start())}function Te(){j&&(F||k.stop(),Le("panend"))}function Se(){Le("zoomend")}function Le(e){W.fire(e,W)}}function V(e){if(e)return"object"==typeof e?(X(e.x)&&X(e.y)||W(e),e):void W()}function W(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function q(){}function X(e){return Number.isFinite(e)}function G(e){return Number.isNaN?Number.isNaN(e):e!=e}!function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var r=e[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var o=t.getAttribute("query");if(o){var i=t.getAttribute("name")||"pz",a=Date.now();!function e(){var n=document.querySelector(o);if(!n){var r=Date.now(),c=r-a;return c<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",i)}var u=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var o=t[r],i=s(o);i&&(n[i.name]=i.value)}return n}(t);console.log(u),window[i]=Y(n,u)}()}}}}function s(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2])return{name:e.name.substr(3),value:JSON.parse(e.value)}}}();var H=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=t[n];return i||(i=t[n]=[]),i.push({callback:r,ctx:o}),e},off:function(n,r){var o=void 0===n;if(o)return t=Object.create(null),e;if(t[n]){var i="function"!=typeof r;if(i)delete t[n];else for(var a=t[n],s=0;s<a.length;++s)a[s].callback===r&&a.splice(s,1)}return e},fire:function(n){var r,o=t[n];if(!o)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<o.length;++i){var a=o[i];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};var $=function(e,t,n){e=e||1,t=t||0,n=n||0,this._array=[e,0,0,0,0,e,0,0,0,0,1,0,t,n,0,1]},Z={scale:{},dx:{},dy:{}};$.prototype.multiply=function(e,t){var n=e.scale*t.scale,r=e.scale*t.dx+e.dx,o=e.scale*t.dy+e.dy;return this.scale=n,this.dx=r,this.dy=o,this},Z.scale.get=function(){return this._array[0]},Z.dx.get=function(){return this._array[12]},Z.dy.get=function(){return this._array[13]},Z.dx.set=function(e){this._array[12]=e},Z.dy.set=function(e){this._array[13]=e},Z.scale.set=function(e){this._array[0]=e,this._array[5]=e},$.prototype.copyTo=function(e){return function(e,t){if(e.length!==t.length)throw new Error("Array length mismatch");for(var n=0;n<e.length;++n)t[n]=e[n]}(this._array,e._array),this},$.prototype.getArray=function(){return this._array},Object.defineProperties($.prototype,Z);var K=function(){this.children=[],this.transform=new $,this.worldTransform=new $,this.worldTransformNeedsUpdate=!0,this.type="Element",this.scene=null};K.prototype.appendChild=function(e,t){e.parent=this,t?this.children.unshift(e):this.children.push(e),e.bindScene&&e.bindScene(this.scene),this.scene&&this.scene.renderFrame()},K.prototype.bindScene=function(e){this.scene=e},K.prototype.traverse=function(e,t){e(this);for(var n=0;n<this.children.length;++n){this.children[n].traverse(e,t)}t&&t(this)},K.prototype.removeChild=function(e){var t=this.children.indexOf(e);t>-1&&this.children.splice(t,1),this.scene&&this.scene.renderFrame()},K.prototype.updateWorldTransform=function(e){(this.worldTransformNeedsUpdate||e)&&(this.parent?this.worldTransform.multiply(this.parent.worldTransform,this.transform):this.transform.copyTo(this.worldTransform),this.worldTransformNeedsUpdate=!1,e=!0);for(var t=e,n=this.children,r=0;r<n.length;r++)t=n[r].updateWorldTransform(e)||t;return t},K.prototype.draw=function(e,t){for(var n=0;n<this.children.length;++n){this.children[n].draw(e,t)}},K.prototype.dispose=function(){for(var e=0;e<this.children.length;++e){this.children[e].dispose()}};var J={maxSingleTouchTime:300,singleTapDistanceSquared:25};function Q(e,t){var n,r,o={width:0,height:0},i=window.devicePixelRatio;t||(t={});var a=t.wglContext,s=e.getContext("webgl",a)||e.getContext("experimental-webgl",a);s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.enable(s.BLEND),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT);var c=0,u=new K;v();var l=H({appendChild:function(e,t){u.appendChild(e,t)},getSceneCoordinate:w,getClientCoordinate:function(e,t){var n=u.transform,r=(e*n.scale+n.dx)/i,o=(t*n.scale+n.dy)/i;return{x:r,y:o}},getTransform:function(){return u.transform},getRoot:function(){return u},getGL:function(){return s},removeChild:function(e){u.removeChild(e)},setViewBox:function(e){h.showRectangle(e,{width:n,height:r});var t=h.getTransform();f.applyTransform(t)},setClearColor:function(e,t,n,r){s.clearColor(e,t,n,r)},clear:function(){s.clear(s.COLOR_BUFFER_BIT)},dispose:function(){e.removeEventListener("mousemove",y),h.off("transform",m),d&&d();window.removeEventListener("resize",p,!0),h.dispose(),u.dispose(),c&&(cancelAnimationFrame(c),c=0)},renderFrame:b,getPixelRatio:function(){return i},setPixelRatio:function(e){i=e,v()},getPanzoom:function(){return h}}),f=function(e,n,r){var o={applyTransform:function(e){var t=n.transform,o=r.getPixelRatio();t.dx=e.x*o,t.dy=e.y*o,t.scale=e.scale,n.worldTransformNeedsUpdate=!0,r.renderFrame()},getOwner:function(){return e}};t.size&&(o.getScreenCTM=function(){return{a:t.size.width/e.offsetWidth,d:t.size.height/e.offsetHeight,e:0,f:0}});return o}(e,u,l);e.style.outline="none",e.setAttribute("tabindex",0);var d,h=j(e,{controller:f});return u.bindScene(l),function(){e.addEventListener("mousemove",y),h.on("transform",m),d=function(e,t,n){var r,o=new Date;return e.addEventListener("click",s),e.addEventListener("touchend",a),e.addEventListener("touchstart",i),function(){e.removeEventListener("click",s),e.removeEventListener("touchend",a),e.removeEventListener("touchstart",i)};function i(e){1===e.touches.length&&(o=new Date,r={x:e.touches[0].pageX,y:e.touches[0].pageY})}function a(e){if(!(e.touches.length>1||new Date-o>J.maxSingleTouchTime)){var t=e.changedTouches[0],n=t.pageX-r.x,i=t.pageY-r.y;n*n+i*i<J.singleTapDistanceSquared&&s(t)}}function s(e){t.call(n,e)}}(e,g,this),window.addEventListener("resize",p,!0)}(),b(),l;function p(){v()}function v(){t.size?(n=e.width=t.size.width,r=e.height=t.size.height):(n=e.width=e.offsetWidth*i,r=e.height=e.offsetHeight*i),s.viewport(0,0,n,r),o.width=n,o.height=r,u.worldTransformNeedsUpdate=!0,b()}function m(e){l.fire("transform",e)}function g(e){var t=w(e.clientX,e.clientY);l.fire("click",{originalEvent:e,sceneX:t.x,sceneY:t.y})}function y(e){var t=w(e.clientX,e.clientY);l.fire("mousemove",{originalEvent:e,sceneX:t.x,sceneY:t.y})}function w(e,t){var n=u.transform,r=t*i;return{x:(e*i-n.dx)/n.scale,y:(r-n.dy)/n.scale}}function b(e){if(e)return x();c||(c=requestAnimationFrame(x))}function x(){s.clear(s.COLOR_BUFFER_BIT),o.wasDirty=u.updateWorldTransform(),u.draw(s,o),c=0}}var ee={compile:function(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r},link:function(e,t,n){var r=e.createProgram();if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(r));return r},getLocations:function(e,t){return{attributes:te(e,t),uniforms:ne(e,t)}},getAttributes:te,getUniforms:ne,initBuffer:function(e,t,n,r){var o=e.createBuffer();if(!o)throw new Error("Failed to create a buffer");e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.vertexAttribPointer(r,n,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r)}};function te(e,t){for(var n=Object.create(null),r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<r;++o){var i=e.getActiveAttrib(t,o).name;n[i]=e.getAttribLocation(t,i)}return n}function ne(e,t){for(var n=Object.create(null),r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=0;o<r;++o){var i=e.getActiveUniform(t,o).name;n[i]=e.getUniformLocation(t,i)}return n}var re={getVSCode:function(e){var t=[];return e.forEach(function(e){e.globals&&t.push(e.globals())}),t.push("void main() {"),e.forEach(function(e){e.mainBody&&t.push(e.mainBody())}),t.push("}"),t.join("\n")}};var oe={globals:function(){return"\nattribute vec2 aPosition;\nuniform vec2 uScreenSize;\nuniform mat4 uTransform;\n"},mainBody:function(){return"\n  mat4 transformed = mat4(uTransform);\n\n  // Translate screen coordinates to webgl space\n  vec2 vv = 2.0 * uTransform[3].xy/uScreenSize;\n  transformed[3][0] = vv.x - 1.0;\n  transformed[3][1] = 1.0 - vv.y;\n  vec2 xy = 2.0 * aPosition/uScreenSize;\n  gl_Position = transformed * vec4(xy.x, -xy.y, 0.0, 1.0);\n"}},ie=re.getVSCode([oe,{globals:function(){return"\nattribute float aPointSize;\nattribute vec4 aColor;\nvarying vec4 vColor;\n"},mainBody:function(){return"\n  gl_PointSize = aPointSize * transformed[0][0];\n  vColor = aColor;\n"}}]),ae="\nprecision highp float;\nvarying vec4 vColor;\nuniform sampler2D texture;\n\nvoid main() {\n  vec4 tColor = texture2D( texture, gl_PointCoord );\n  gl_FragColor = vec4(vColor.rgb, tColor.a);\n  //gl_FragColor = vec4(vColor.rgb, 1.0);\n  // vec2 t = 2.0 * gl_PointCoord - 1.0;\n  // float a = 1.0 - pow(t.x, 2.0) - pow(t.y, 2.0);\n  // gl_FragColor = vec4(vColor.rgb, a);\n}\n",se=new Map;function ce(e,t){var n=se.get(e);if(!n){var r=ee.compile(e,e.VERTEX_SHADER,ie),o=ee.compile(e,e.FRAGMENT_SHADER,ae);n=ee.link(e,r,o),se.set(e,n)}var i=ee.getLocations(e,n),a=e.createBuffer();if(!a)throw new Error("failed to create a nodesBuffer");e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,t.byteLength,e.DYNAMIC_DRAW);var s=function(e){var t=e.createTexture();if(!t)throw new Error("Failed to create circle texture");e.bindTexture(e.TEXTURE_2D,t);var n=function(e){for(var t=new Uint8Array(e*e*4),n=(e-8)/2,r=0;r<e;++r)for(var o=r*e,i=0;i<e;++i){var a=4*(o+i),s=r-n,c=i-n,u=Math.sqrt(c*c+s*s);if(u<n){var l=1-u/n;t[a+3]=l>.3?255:255*l}else t[a+3]=0}return function(e,t){for(var n=new Uint8Array(t*t*4),r=0;r<t;++r)for(var o=0;o<t;++o)n[4*(r*t+o)+3]=ue(r,o,3,e,t);return n}(t,e)}(64);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,64,64,0,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),t}(e);return{draw:function(r,o,c){e.useProgram(n);var u=t.BYTES_PER_ELEMENT;r&&e.uniformMatrix4fv(i.uniforms.uTransform,!1,r.getArray());e.uniform2f(i.uniforms.uScreenSize,o.width,o.height),e.bindTexture(e.TEXTURE_2D,s),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,t,e.DYNAMIC_DRAW),e.vertexAttribPointer(i.attributes.aPosition,2,e.FLOAT,!1,6*u,0),e.enableVertexAttribArray(i.attributes.aPosition),e.vertexAttribPointer(i.attributes.aPointSize,1,e.FLOAT,!1,6*u,2*u),e.enableVertexAttribArray(i.attributes.aPointSize),e.vertexAttribPointer(i.attributes.aColor,3,e.FLOAT,!1,6*u,3*u),e.enableVertexAttribArray(i.attributes.aColor),e.drawArrays(e.POINTS,0,c)},updateData:function(e){t=e},dispose:function(){e.deleteProgram(n),e.deleteTexture(s),se.delete(e)}}}function ue(e,t,n,r,o){for(var i=0,a=0,s=e-n;s<e+n;++s)if(!(s<0||s>=o))for(var c=t-n;c<t+n;++c)c<0||c>=o||(i+=r[4*(s*o+c)+3],a+=1);return i/a}var le=function(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=void 0===r?1:r},fe=function(e,t,n,r){this.offset=t,this.buffer=e,this.color=n||new le(1,1,1,1),void 0!==r&&(this.data=r)},de={x:{},y:{}};de.x.get=function(){return this.buffer[this.offset]},de.y.get=function(){return this.buffer[this.offset+1]},fe.prototype.update=function(e,t){var n=this.offset,r=this.buffer;r[n+0]=e.x,r[n+1]=e.y,(e.size||t)&&(r[n+2]="number"==typeof e.size?e.size:t.size),this.setColor(this.color)},fe.prototype.setColor=function(e){this.color=e,this.buffer[this.offset+3]=e.r,this.buffer[this.offset+4]=e.g,this.buffer[this.offset+5]=e.b},Object.defineProperties(fe.prototype,de);var he=6,pe=function(e){function t(t){e.call(this),this.type="PointCollection",this.pointsAccessor=[],this.capacity=t,this.pointsBuffer=new Float32Array(t*he),this.count=0,this._program=null,this.color=new le(1,1,1,1),this.size=1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.draw=function(e,t){this._program||(this._program=ce(e,this.pointsBuffer)),this._program.draw(this.worldTransform,t,this.count)},t.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null)},t.prototype.add=function(e,t){if(!e)throw new Error("Point is required");this.count>=this.capacity&&this._extendArray();var n=this.pointsBuffer,r=this.count,o=new fe(n,r*he,e.color||this.color,t);return this.pointsAccessor.push(o),o.update(e,this),this.count+=1,o},t.prototype._extendArray=function(){throw new Error("Cannot extend array at the moment :(")},t}(K),ve=function(e,t,n){if(Number.isNaN(e))throw new Error("x is not a number");if(Number.isNaN(t))throw new Error("y is not a number");this.x=e,this.y=t,this.color=new le(255,255,255),this.size=Number.isFinite(n)?n:4},me=function(e){function t(t,n){e.call(this),this.itemsPerLine=n,this.capacity=t,this.count=0,this._program=null,this.color=new le(1,1,1,1),this.buffer=new Float32Array(t*this.itemsPerLine)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.draw=function(e,t){this._program||(this._program=this._makeProgram(e));var n=this.worldTransform;this._program.draw(n,this.color,t)},t.prototype._makeProgram=function(){throw new Error("Not implemented")},t.prototype._addInternal=function(){throw new Error("Not implemented")},t.prototype.add=function(e){if(!e)throw new Error("Line is required");this.count>=this.capacity&&this._extendArray();var t=this.count*this.itemsPerLine,n=this._addInternal(e,t);return this.count+=1,n},t.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null)},t.prototype._extendArray=function(){var e=this.capacity*this.itemsPerLine*2,t=new Float32Array(e);this.buffer&&t.set(this.buffer),this.buffer=t,this.capacity=e},t}(K),ge=re.getVSCode([oe]),ye="\nprecision highp float;\nuniform vec4 uColor;\n\nvoid main() {\n  gl_FragColor = uColor;\n}\n",we=new Map;function be(e,t,n){var r=we.get(e);if(!r){var o=ee.compile(e,e.VERTEX_SHADER,ge),i=ee.compile(e,e.FRAGMENT_SHADER,ye);r=ee.link(e,o,i),we.set(e,r)}var a=ee.getLocations(e,r),s=e.createBuffer(),c=t.BYTES_PER_ELEMENT,u=n?e.TRIANGLES:e.LINES;return e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,t.byteLength,e.STATIC_DRAW),e.bufferSubData(e.ARRAY_BUFFER,0,t),{draw:function(n,o,i){if(0===t.length)return;e.useProgram(r),e.uniformMatrix4fv(a.uniforms.uTransform,!1,n.getArray()),e.uniform2f(a.uniforms.uScreenSize,i.width,i.height),e.uniform4f(a.uniforms.uColor,o.r,o.g,o.b,o.a),e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(a.attributes.aPosition),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.vertexAttribPointer(a.attributes.aPosition,2,e.FLOAT,!1,2*c,0),e.drawArrays(u,0,t.length/2)},dispose:function(){e.deleteBuffer(s),e.deleteProgram(r),we.delete(e)}}}var xe=function(e,t){this.offset=t,this.buffer=e,this.width=1};xe.prototype.setWidth=function(e){this.width=e},xe.prototype.update=function(e,t){var n=this.buffer,r=this.offset,o=t.x-e.x,i=t.y-e.y;0===o&&(o=1e-4),0===i&&(i=1e-4);var a=Math.sqrt(o*o+i*i),s=o/a,c=i/a,u=this.width,l=u*s,f=u*c,d=e.x+f,h=e.y-l,p=t.x+f,v=t.y-l,m=e.x-f,g=e.y+l,y=t.x-f,w=t.y+l;n[r+0]=d,n[r+1]=h,n[r+2]=p,n[r+3]=v,n[r+4]=m,n[r+5]=g,n[(r+=6)+0]=p,n[r+1]=v,n[r+2]=m,n[r+3]=g,n[r+4]=y,n[r+5]=w};var _e=function(e){function t(t){e.call(this,t,12),this.type="LineCollection"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._makeProgram=function(e){return be(e,this.buffer,!0)},t.prototype._addInternal=function(e,t){var n=new xe(this.buffer,t);return n.update(e.from,e.to),n},t}(me),Ce=function(e,t){this.offset=t,this.buffer=e};Ce.prototype.update=function(e,t){var n=this.buffer,r=this.offset;n[r+0]=e.x,n[r+1]=e.y,n[r+2]=t.x,n[r+3]=t.y};var Ee=function(e){function t(t){e.call(this,t,4),this.type="WireCollection"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._makeProgram=function(e){return be(e,this.buffer,!1)},t.prototype._addInternal=function(e,t){var n=new Ce(this.buffer,t);return n.update(e.from,e.to),n},t}(me),ke=new Map;function Te(e,t,n){var r=ke.get(e),o=n?3:2;if(!r){var i=function(e){return{lineVSSrc:re.getVSCode([{globals:function(){return"\n  attribute vec2 aPosition;\n  varying vec4 vColor;\n  "+(e?"attribute vec4 aColor;":"")+"\n  uniform vec4 uColor;\n  uniform vec2 uScreenSize;\n  uniform mat4 uTransform;\n"},mainBody:function(){return"\n  mat4 transformed = mat4(uTransform);\n\n  // Translate screen coordinates to webgl space\n  vec2 vv = 2.0 * uTransform[3].xy/uScreenSize;\n  transformed[3][0] = vv.x - 1.0;\n  transformed[3][1] = 1.0 - vv.y;\n  vec2 xy = 2.0 * aPosition.xy/uScreenSize;\n  gl_Position = transformed * vec4(xy.x, -xy.y, 0.0, 1.0);\n  vColor = "+(e?"aColor.abgr":"uColor")+";\n"}}]),lineFSSrc:"precision mediump float;\nvarying vec4 vColor;\nvoid main() {\n  gl_FragColor = vColor;\n}\n"}}(n),a=i.lineFSSrc,s=i.lineVSSrc,c=ee.compile(e,e.VERTEX_SHADER,s),u=ee.compile(e,e.FRAGMENT_SHADER,a);r=ee.link(e,c,u),ke.set(e,r)}var l=ee.getLocations(e,r),f=e.createBuffer();return{draw:function(i,a,s,c,u){if(0===t.length)return;e.useProgram(r);var d=i.getArray();e.uniformMatrix4fv(l.uniforms.uTransform,!1,d),e.uniform2f(l.uniforms.uScreenSize,s.width,s.height),e.uniform4f(l.uniforms.uColor,a.r,a.g,a.b,a.a),e.bindBuffer(e.ARRAY_BUFFER,f),e.enableVertexAttribArray(l.attributes.aPosition),e.bufferData(e.ARRAY_BUFFER,t,e.DYNAMIC_DRAW),n?(e.vertexAttribPointer(l.attributes.aPosition,2,e.FLOAT,!1,12,0),e.enableVertexAttribArray(l.attributes.aColor),e.vertexAttribPointer(l.attributes.aColor,4,e.UNSIGNED_BYTE,!0,12,8)):e.vertexAttribPointer(l.attributes.aPosition,2,e.FLOAT,!1,0,0);if(u){var h=t.byteLength/4/o-c;e.drawArrays(e.LINE_STRIP,c,h),c>1&&e.drawArrays(e.LINE_STRIP,0,c-1)}else e.drawArrays(e.LINE_STRIP,1,c-1)},dispose:function(){e.deleteBuffer(f),e.deleteProgram(r),ke.delete(e)}}}var Se=function(e){function t(t,n){void 0===n&&(n=!1),e.call(this);this.drawCount=0,this.madeFullCircle=!1,this.allowColors=n,this.itemsPerLine=n?3:2,this.capacity=t,this.nextElementIndex=1,this._program=null,this.color=new le(1,1,1,1),this.buffer=new ArrayBuffer((t+1)*this.itemsPerLine*4),this.positions=new Float32Array(this.buffer),n&&(this.colors=new Uint32Array(this.buffer))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.draw=function(e,t){this._program||(this._program=Te(e,this.buffer,this.allowColors));var n=this.worldTransform;this._program.draw(n,this.color,t,this.nextElementIndex,this.madeFullCircle)},t.prototype.add=function(e,t,n){var r=this.nextElementIndex*this.itemsPerLine,o=this.positions;o[r]=e,o[r+1]=t,this.allowColors&&(this.colors[r+2]=void 0===n?0:n),this.nextElementIndex+=1,this.drawCount+=1,this.nextElementIndex>this.capacity&&(this.nextElementIndex=1,o[0]=e,o[1]=t,this.allowColors&&(this.colors[2]=this.colors[r+2]),this.madeFullCircle=!0)},t.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null)},t}(K);function Le(e){try{return!!window.WebGLRenderingContext&&(e||(e=document.createElement("canvas")),!(!e.getContext("webgl")&&!e.getContext("experimental-webgl")))}catch(e){return!1}}}.call(t,n("DuR2"))},YzTF:function(e,t,n){"use strict";(function(e){var t=n("pFYg"),r=n.n(t);!function(t){var o=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,i=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),a=i&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),s=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,c=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,u=(i||s)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,n,r,o,u,l,f,d,h;if(!(t=e.match(c)))throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),r=!!t[4],o=e.slice(t[0].length),u=r?atob(o):decodeURIComponent(o),l=new ArrayBuffer(u.length),f=new Uint8Array(l),d=0;d<u.length;d+=1)f[d]=u.charCodeAt(d);return i?new Blob([a?f:l],{type:n}):((h=new s).append(l),h.getBlob(n))};t.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(e,t,n){var r=this;setTimeout(function(){n&&o.toDataURL&&u?e(u(r.toDataURL(t,n))):e(r.mozGetAsFile("blob",t))})}:o.toDataURL&&u&&(o.toBlob=function(e,t,n){var r=this;setTimeout(function(){e(u(r.toDataURL(t,n)))})})),"function"==typeof define&&n("nErl")?define(function(){return u}):"object"===r()(e)&&e.exports?e.exports=u:t.dataURLtoBlob=u}(window)}).call(t,n("f1Eh")(e))},kfvp:function(e,t,n){var r=n("YrBu");n("MeRj").place;e.exports=function(e,t,n){(new Date).toISOString();var o=1/window.devicePixelRatio,i=['<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: https://github.com/anvaka/city-roads\nData Â© OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n--\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n   viewBox="'+t.left+" "+t.top+" "+t.width+" "+t.height+'">\n   <style>\n   path {\n    vector-effect: non-scaling-stroke;\n   }\n   </style>\n   <rect id="background" fill="'+n.background+'" x="'+t.left+'" y="'+t.top+'" width="'+t.width+'" height="'+t.height+'"></rect>\n'];return e.forEach(function(e){return function(e){var n=e.grid;if(!n)return;var a=r(e.color).toHexString();i.push('<g id="'+e.id+'" fill="none" stroke="'+a+'" stroke-width="'+o+'">');var s=n.nodes,c=n.getProjector();n.forEachElement(function(e){if("way"===e.type){var n=null,r=!1,o=e.nodes.map(function(e){var o=c(s.get(e));if(!function(e,t){return e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom}(o,t)){var i=null===n?"M":"L",a=i!==n;return"L"===i&&(r=!0),n=i,""+(a?i:"")+o.x+","+o.y}n=null}).filter(function(e){return e}).join(" ");r&&i.push('<path d="'+o+'" />')}}),i.push("</g>")}(e)}),function(){window.innerWidth,t.width,window.innerHeight,t.height;n.labels.map(function(e){if(e.text){var n=e.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),r=e.bounds,o=t.width*r.right/window.innerWidth+t.left,i=t.height*r.bottom/window.innerHeight+t.top,a=t.height*e.fontSize/window.innerHeight,s=e.fontFamily.replace(/"/g,"'");return'<text text-anchor="end" x="'+o+'" y="'+i+'" fill="'+e.color+'" font-family="'+s+'" font-size="'+a+'">'+n+"</text>"}}).forEach(function(e){e&&i.push(e)})}(),i.push("</svg>"),i.join("\n")}},om41:function(e,t){},tvtY:function(e,t){},z3MC:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.7dd18a5ff5e0e313b06c.js.map